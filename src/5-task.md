# Задание 5

## Условие

Придумать транспортную задачу закрытого типа, размерность 5 x 4.  
Решить методом северно-западного угла, методом минимальных элементов, методом потенциалов.

## Постановка задачи

Рассмотрим закрытую транспортную задачу размером 5 x 4 с пятью потребителями и четырьмя поставщиками. Общий объем поставок равен общему объему спроса.

**Запасы поставщиков**  
$A_1 = 15, \quad A_2 = 75, \quad A_3 = 150, \quad A_4 = 175, \quad A_5 = 200$

**Потребности потребителей**  
$B_1 = 200, \quad B_2 = 190, \quad B_3 = 75, \quad B_4 = 150$

_Проверим общий баланс_  
$A_1 + A_2 + A_3 + A_4 + A_5 = B_1 + B_2 + B_3 + B_4 = 615$

Так как общий запас равен общему спросу, задача является закрытой.

**Тарифы маршрутов**

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & Запасы \\ \hline
        $A_1$ & 2 & 4 & 3 & 2 & 15 \\ \hline
        $A_2$ & 3 & 1 & 2 & 3 & 75 \\ \hline
        $A_3$ & 1 & 2 & 1 & 4 & 150 \\ \hline
        $A_4$ & 3 & 3 & 2 & 1 & 175 \\ \hline
        $A_5$ & 4 & 2 & 3 & 2 & 200 \\ \hline
        Потребности & 200 & 190 & 75 & 150 & ~ \\ \hline
\end{tabular}
$$

Задача состоит в том, чтобы минимизировать общую стоимость транспортировки при соблюдении ограничений на запасы и потребности.  
Целевая функция:  
$F = 2 \cdot x_{11} + 4 \cdot x_{12} + 3 \cdot x_{13} + \dots + 3 \cdot x_{53} + 2 \cdot x_{54} \to \min$

Ограничения:

$$
\begin{cases}
    x_{11} + x_{12} + x_{13} + x_{14} = 15 \\
    x_{21} + x_{22} + x_{23} + x_{24} = 75 \\
    x_{31} + x_{32} + x_{33} + x_{34} = 150 \\
    x_{41} + x_{42} + x_{43} + x_{44} = 175 \\
    x_{51} + x_{52} + x_{53} + x_{54} = 200 \\
    x_{11} + x_{21} + x_{31} + x_{41} + x_{51} = 200 \\
    x_{12} + x_{22} + x_{32} + x_{42} + x_{52} = 190 \\
    x_{13} + x_{23} + x_{33} + x_{43} + x_{53} = 75 \\
    x_{14} + x_{24} + x_{34} + x_{44} + x_{54} = 150 \\
    x_{ij} \geq 0
\end{cases}
$$

## Метод северо-западного угла

Метод северо-западного угла предполагает заполнение транспортной таблицы, начиная с левой верхней ячейки и двигаясь по строкам и столбцам. На каждом шаге распределяем максимум возможного количества товара в текущую ячейку, обновляя остатки.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & Запасы \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & 15 \\ \hline
        $A_2$ & $75_3$ & $_1$ & $_2$ & $_3$ & 75 \\ \hline
        $A_3$ & $110_1$ & $40_2$ & $_1$ & $_4$ & 150 \\ \hline
        $A_4$ & $_3$ & $150_3$ & $25_2$ & $_1$ & 175 \\ \hline
        $A_5$ & $_4$ & $_2$ & $50_3$ & $150_2$ & 200 \\ \hline
        Потребности & 200 & 190 & 75 & 150 & ~ \\ \hline
\end{tabular}
$$

Вычислим общую стоимость транспортировки:  
$F = 15 \cdot 2 + 75 \cdot 3 + 110 \cdot 1 + 40 \cdot 2 + 150 \cdot 3 + 25 \cdot 2 + 50 \cdot 3 + 150 \cdot 2 = 30 + 225 + 110 + 80 + 450 + 50 + 150 + 300 = 1395$

Итоговое распределение:

$$
X = \begin{pmatrix}
    15 & 0 & 0 & 0 \\
    75 & 0 & 0 & 0 \\
    110 & 40 & 0 & 0 \\
    0 & 150 & 25 & 0 \\
    0 & 0 & 50 & 150
\end{pmatrix}
$$

## Метод минимального элемента

Метод минимального элемента предполагает нахождение минимального элемента в таблице и заполнение его максимально возможным количеством товара. После этого пересчитываются остатки и процедура повторяется до тех пор, пока все потребности не будут удовлетворены.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & Запасы \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & 15 \\ \hline
        $A_2$ & $_3$ & $75_1$ & $_2$ & $_3$ & 75 \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & 150 \\ \hline
        $A_4$ & $_3$ & $_3$ & $25_2$ & $150_1$ & 175 \\ \hline
        $A_5$ & $35_4$ & $115_2$ & $50_3$ & $_2$ & 200 \\ \hline
        Потребности & 200 & 190 & 75 & 150 & ~ \\ \hline
\end{tabular}
$$

Вычислим общую стоимость транспортировки:  
$F = 15 \cdot 2 + 150 \cdot 1 + 35 \cdot 4 + 75 \cdot 1 + 115 \cdot 2 + 25 \cdot 2 + 50 \cdot 3 + 150 \cdot 1 = 30 + 150 + 140 + 75 + 230 + 50 + 150 + 150 = 975$

Итоговое распределение:

$$
X = \begin{pmatrix}
    15 & 0 & 150 & 0 & 35 \\
    0 & 75 & 0 & 0 & 115 \\
    0 & 0 & 0 & 25 & 50 \\
    0 & 0 & 0 & 150 & 0
\end{pmatrix}
$$

## Метод потенциалов

Каждому поставщику $A_i$ ставим в соответствие некоторое число $U_i$, называемое потенциалом поставщика.  
Каждому потребителю $B_j$ ставим в соответствие некоторое число $V_j$, называемое потенциалом потребителя.  
Для задействованного маршрута:  
потенциал поставщика + потенциал потребителя = тариф задействованного маршрута.  
Последовательно найдем значения потенциалов.  
Значение одного потенциала необходимо задать. Пусть $U_3 = 0$.

$$
\begin{aligned}
&A_3B_1 : v_1 + u_3 = 1 \quad \Rightarrow \quad v_1 = 1 - 0 = 1 \\
&A_3B_2 : v_2 + u_3 = 2 \quad \Rightarrow \quad v_2 = 2 - 0 = 2 \\
&A_4B_2 : v_2 + u_4 = 3 \quad \Rightarrow \quad u_4 = 3 - 2 = 1 \\
&A_4B_3 : v_3 + u_4 = 2 \quad \Rightarrow \quad v_3 = 2 - 1 = 1 \\
&A_5B_3 : v_3 + u_5 = 3 \quad \Rightarrow \quad u_5 = 3 - 1 = 2 \\
&A_5B_4 : v_4 + u_5 = 2 \quad \Rightarrow \quad v_4 = 2 - 2 = 0 \\
&A_1B_1 : v_1 + u_1 = 2 \quad \Rightarrow \quad u_1 = 2 - 1 = 1 \\
&A_2B_1 : v_1 + u_2 = 3 \quad \Rightarrow \quad u_2 = 3 - 1 = 2
\end{aligned}
$$

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=1$ \\ \hline
        $A_2$ & $75_3$ & $_1$ & $_2$ & $_3$ & $u_2=2$ \\ \hline
        $A_3$ & $110_1$ & $40_2$ & $_1$ & $_4$ & $u_3=0$ \\ \hline
        $A_4$ & $_3$ & $150_3$ & $25_2$ & $_1$ & $u_4=1$ \\ \hline
        $A_5$ & $_4$ & $_2$ & $50_3$ & $150_2$ & $u_5=2$ \\ \hline
        $V$ & $v_1=1$ & $v_2=2$ & $v_3=1$ & $v_4=0$ & ~ \\ \hline
\end{tabular}
$$

Найдем оценки незадействованных маршрутов ($c_{ij}$ - тариф):

$$
\begin{aligned}
&A_1B_2 : c_{12} - (u_1 + v_2) = 4 - (1 + 2) = 1 \\
&A_1B_3 : c_{13} - (u_1 + v_3) = 3 - (1 + 1) = 1 \\
&A_1B_4 : c_{14} - (u_1 + v_4) = 2 - (1 + 0) = 1 \\
&A_2B_2 : c_{22} - (u_2 + v_2) = 1 - (2 + 2) = -3 \\
&A_2B_3 : c_{23} - (u_2 + v_3) = 2 - (2 + 1) = -1 \\
&A_2B_4 : c_{24} - (u_2 + v_4) = 3 - (2 + 0) = 1 \\
&A_3B_3 : c_{33} - (u_3 + v_3) = 1 - (0 + 1) = 0 \\
&A_3B_4 : c_{34} - (u_3 + v_4) = 4 - (0 + 0) = 4 \\
&A_4B_1 : c_{41} - (u_4 + v_1) = 3 - (1 + 1) = 1 \\
&A_4B_4 : c_{44} - (u_4 + v_4) = 1 - (1 + 0) = 0 \\
&A_5B_1 : c_{51} - (u_5 + v_1) = 4 - (2 + 1) = 1 \\
&A_5B_2 : c_{52} - (u_5 + v_2) = 2 - (2 + 2) = -2 \\
\end{aligned}
$$

Есть отрицательные оценки. Следовательно, возможно получить новое решение, как минимум, не хуже имеющегося.

### Шаги метода потенциалов

#### Шаг 1

Выберем ячейку с наименьшей оценкой. Это ячейка $A_2B_2$.  
Используя только горизонтальные и вертикальные перемещения курсора, соединим непрерывной линией заполненные ячейки так, чтобы вернуться в исходную ячейку.
Ячейки, расположенные в вершинах построенной ломаной линии, образуют цикл для выбранной ячейки. Он единственный. Направление обхода не имеет значения.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=1$ \\ \hline
        $A_2$ & \cellcolor[HTML]{E0FFFF} $75_3$ & \cellcolor[HTML]{BDFDCC} $_1$ & $_2$ & $_3$ & $u_2=2$ \\ \hline
        $A_3$ & \cellcolor[HTML]{BDFDCC} $110_1$ & \cellcolor[HTML]{E0FFFF} $40_2$ & $_1$ & $_4$ & $u_3=0$ \\ \hline
        $A_4$ & $_3$ & $150_3$ & $25_2$ & $_1$ & $u_4=1$ \\ \hline
        $A_5$ & $_4$ & $_2$ & $50_3$ & $150_2$ & $u_5=2$ \\ \hline
        $V$ & $v_1=1$ & $v_2=2$ & $v_3=1$ & $v_4=0$ & ~ \\ \hline
\end{tabular}
$$

$\min(75, 40) = 40$  
Перераспределим товар по циклу:

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=1$ \\ \hline
        $A_2$ & \cellcolor[HTML]{E0FFFF} $35_3$ & \cellcolor[HTML]{BDFDCC} $40_1$ & $_2$ & $_3$ & $u_2=2$ \\ \hline
        $A_3$ & \cellcolor[HTML]{BDFDCC} $150_1$ & \cellcolor[HTML]{E0FFFF} $_2$ & $_1$ & $_4$ & $u_3=0$ \\ \hline
        $A_4$ & $_3$ & $150_3$ & $25_2$ & $_1$ & $u_4=1$ \\ \hline
        $A_5$ & $_4$ & $_2$ & $50_3$ & $150_2$ & $u_5=2$ \\ \hline
        $V$ & $v_1=1$ & $v_2=2$ & $v_3=1$ & $v_4=0$ & ~ \\ \hline
\end{tabular}
$$

Получили новое решение. Проверим его оптимальность.  
Пусть $U_2 = 0$.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & $150_3$ & $25_2$ & $_1$ & $u_4=2$ \\ \hline
        $A_5$ & $_4$ & $_2$ & $50_3$ & $150_2$ & $u_5=3$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=0$ & $v_4=-1$ & ~ \\ \hline
\end{tabular}
$$

Найдем оценки незадействованных маршрутов ($c_{ij}$ - тариф):

$$
\begin{aligned}
&A_1B_2 : c_{12} - (u_1 + v_2) = 4 - (-1 + 1) = 4 \\
&A_1B_3 : c_{13} - (u_1 + v_3) = 3 - (-1 + 0) = 4 \\
&A_1B_4 : c_{14} - (u_1 + v_4) = 2 - (-1 + (-1)) = 4 \\
&A_2B_3 : c_{23} - (u_2 + v_3) = 2 - (0 + 0) = 2 \\
&A_2B_4 : c_{24} - (u_2 + v_4) = 3 - (0 + (-1)) = 4 \\
&A_3B_2 : c_{32} - (u_3 + v_2) = 2 - (-2 + 1) = 3 \\
&A_3B_3 : c_{33} - (u_3 + v_3) = 1 - (-2 + 0) = 3 \\
&A_3B_4 : c_{34} - (u_3 + v_4) = 4 - (-2 + (-1)) = 7 \\
&A_4B_1 : c_{41} - (u_4 + v_1) = 3 - (2 + 3) = -2 \\
&A_4B_4 : c_{44} - (u_4 + v_4) = 1 - (2 + (-1)) = 0 \\
&A_5B_1 : c_{51} - (u_5 + v_1) = 4 - (3 + 3) = -2 \\
&A_5B_2 : c_{52} - (u_5 + v_2) = 2 - (3 + 1) = -2
\end{aligned}
$$

Есть отрицательные оценки. Следовательно, возможно получить новое решение, как минимум, не хуже имеющегося.

#### Шаг 2

Выберем одну из ячеек с наименьшей оценкой. Это ячейка $A_5B_2$.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & \cellcolor[HTML]{BDFDCC} $150_3$ & \cellcolor[HTML]{E0FFFF} $25_2$ & $_1$ & $u_4=2$ \\ \hline
        $A_5$ & $_4$ & \cellcolor[HTML]{E0FFFF} $_2$ & \cellcolor[HTML]{BDFDCC} $50_3$ & $150_2$ & $u_5=3$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=0$ & $v_4=-1$ & ~ \\ \hline
\end{tabular}
$$

$\min(150, 50) = 50$  
Перераспределим товар по циклу:

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & \cellcolor[HTML]{BDFDCC} $100_3$ & \cellcolor[HTML]{E0FFFF} $75_2$ & $_1$ & $u_4=2$ \\ \hline
        $A_5$ & $_4$ & \cellcolor[HTML]{E0FFFF} $50_2$ & \cellcolor[HTML]{BDFDCC} $_3$ & $150_2$ & $u_5=3$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=0$ & $v_4=-1$ & ~ \\ \hline
\end{tabular}
$$

Получили новое решение. Проверим его оптимальность.  
Пусть $U_2 = 0$.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & $100_3$ & $75_2$ & $_1$ & $u_4=2$ \\ \hline
        $A_5$ & $_4$ & $50_2$ & $_3$ & $150_2$ & $u_5=1$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=0$ & $v_4=1$ & ~ \\ \hline
\end{tabular}
$$

Найдем оценки незадействованных маршрутов ($c_{ij}$ - тариф):

$$
\begin{aligned}
&A_1B_2 : c_{12} - (u_1 + v_2) = 4 - (-1 + 1) = 4 \\
&A_1B_3 : c_{13} - (u_1 + v_3) = 3 - (-1 + 0) = 4 \\
&A_1B_4 : c_{14} - (u_1 + v_4) = 2 - (-1 + 1) = 2 \\
&A_2B_3 : c_{23} - (u_2 + v_3) = 2 - (0 + 0) = 2 \\
&A_2B_4 : c_{24} - (u_2 + v_4) = 3 - (0 + 1) = 2 \\
&A_3B_2 : c_{32} - (u_3 + v_2) = 2 - (-2 + 1) = 3 \\
&A_3B_3 : c_{33} - (u_3 + v_3) = 1 - (-2 + 0) = 3 \\
&A_3B_4 : c_{34} - (u_3 + v_4) = 4 - (-2 + 1) = 5 \\
&A_4B_1 : c_{41} - (u_4 + v_1) = 3 - (2 + 3) = -2 \\
&A_4B_4 : c_{44} - (u_4 + v_4) = 1 - (2 + 1) = -2 \\
&A_5B_1 : c_{51} - (u_5 + v_1) = 4 - (1 + 3) = 0 \\
&A_5B_3 : c_{53} - (u_5 + v_3) = 3 - (1 + 0) = 2
\end{aligned}
$$

Есть отрицательные оценки. Следовательно, возможно получить новое решение, как минимум, не хуже имеющегося.

#### Шаг 3

Выберем одну из ячеек с наименьшей оценкой. Это ячейка $A_4B_4$.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & \cellcolor[HTML]{BDFDCC} $100_3$ & $75_2$ & \cellcolor[HTML]{E0FFFF} $_1$ & $u_4=2$ \\ \hline
        $A_5$ & $_4$ & \cellcolor[HTML]{E0FFFF} $50_2$ & $_3$ & \cellcolor[HTML]{BDFDCC} $150_2$ & $u_5=1$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=0$ & $v_4=1$ & ~ \\ \hline
\end{tabular}
$$

$\min(100, 150) = 100$  
Перераспределим товар по циклу:

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & \cellcolor[HTML]{BDFDCC} $_3$ & $75_2$ & \cellcolor[HTML]{E0FFFF} $100_1$ & $u_4=2$ \\ \hline
        $A_5$ & $_4$ & \cellcolor[HTML]{E0FFFF} $150_2$ & $_3$ & \cellcolor[HTML]{BDFDCC} $50_2$ & $u_5=1$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=0$ & $v_4=1$ & ~ \\ \hline
\end{tabular}
$$

Получили новое решение. Проверим его оптимальность.  
Пусть $U_2 = 0$.

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        ~ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $U$ \\ \hline
        $A_1$ & $15_2$ & $_4$ & $_3$ & $_2$ & $u_1=-1$ \\ \hline
        $A_2$ & $35_3$ & $40_1$ & $_2$ & $_3$ & $u_2=0$ \\ \hline
        $A_3$ & $150_1$ & $_2$ & $_1$ & $_4$ & $u_3=-2$ \\ \hline
        $A_4$ & $_3$ & $_3$ & $75_2$ & $100_1$ & $u_4=0$ \\ \hline
        $A_5$ & $_4$ & $150_2$ & $_3$ & $50_2$ & $u_5=1$ \\ \hline
        $V$ & $v_1=3$ & $v_2=1$ & $v_3=2$ & $v_4=1$ & ~ \\ \hline
\end{tabular}
$$

Найдем оценки незадействованных маршрутов ($c_{ij}$ - тариф):

$$
\begin{aligned}
&A_1B_2 : c_{12} - (u_1 + v_2) = 4 - (-1 + 1) = 4 \\
&A_1B_3 : c_{13} - (u_1 + v_3) = 3 - (-1 + 2) = 2 \\
&A_1B_4 : c_{14} - (u_1 + v_4) = 2 - (-1 + 1) = 2 \\
&A_2B_3 : c_{23} - (u_2 + v_3) = 2 - (0 + 2) = 0 \\
&A_2B_4 : c_{24} - (u_2 + v_4) = 3 - (0 + 1) = 2 \\
&A_3B_2 : c_{32} - (u_3 + v_2) = 2 - (-2 + 1) = 3 \\
&A_3B_3 : c_{33} - (u_3 + v_3) = 1 - (-2 + 2) = 1 \\
&A_3B_4 : c_{34} - (u_3 + v_4) = 4 - (-2 + 1) = 5 \\
&A_4B_1 : c_{41} - (u_4 + v_1) = 3 - (0 + 3) = 0 \\
&A_4B_2 : c_{42} - (u_4 + v_2) = 3 - (0 + 1) = 2 \\
&A_5B_1 : c_{51} - (u_5 + v_1) = 4 - (1 + 3) = 0 \\
&A_5B_3 : c_{53} - (u_5 + v_3) = 3 - (1 + 2) = 0
\end{aligned}
$$

Нет отрицательных оценок. Следовательно, уменьшить общую стоимость доставки продукции невозможно.

### Вывод

Посчитаем общую стоимость транспортировки:  
$F = 15 \cdot 2 + 35 \cdot 3 + 150 \cdot 1 + 40 \cdot 1 + 150 \cdot 2 + 75 \cdot 2 + 100 \cdot 1 + 50 \cdot 2 = 30 + 105 + 150 + 40 + 300 + 150 + 100 + 100 = 975$

Итоговое распределение:

$$
X = \begin{pmatrix}
    15 & 0 & 0 & 0 \\
    35 & 40 & 0 & 0 \\
    150 & 0 & 0 & 0 \\
    0 & 0 & 75 & 100 \\
    0 & 150 & 0 & 50
\end{pmatrix}
$$

## Решение с помощью Python

```python
from cvxopt.modeling import variable, op
import time

start_time = time.time()

# Variables
x = variable(20, 'x')

# Tariff
c = [
    2, 4, 3, 2,
    3, 1, 2, 3,
    1, 2, 1, 4,
    3, 3, 2, 1,
    4, 2, 3, 2,
]

# Objective function
z = sum(c[i] * x[i] for i in range(20))

# Constraints
supply = [15, 75, 150, 175, 200]
demand = [200, 190, 75, 150]

constraints = []
for i in range(5):
    constraints.append(sum(x[i * 4 + j] for j in range(4)) <= supply[i])
for j in range(4):
    constraints.append(sum(x[i * 4 + j] for i in range(5)) == demand[j])

x_non_negative = (x >= 0)
constraints.append(x_non_negative)

# Problem
problem = op(z, constraints)

# Solve
problem.solve(solver='glpk')

# Results
print("Xopt:")
for i in range(5):
    for j in range(4):
        print(x.value[i * 4 + j], end='\t')
    print()

print(f'Total cost: {problem.objective.value()[0]}')
print(f'took: {round(time.time() - start_time, 3)} seconds')
```

### Вывод

```plaintext
GLPK Simplex Optimizer 5.0
29 rows, 20 columns, 60 non-zeros
      0: obj =   0.000000000e+00 inf =   6.150e+02 (4)
      8: obj =   1.395000000e+03 inf =   0.000e+00 (0)
*    20: obj =   9.750000000e+02 inf =   0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Xopt:
15.0	0.0	0.0	0.0
0.0	75.0	0.0	0.0
150.0	0.0	0.0	0.0
35.0	0.0	75.0	65.0
0.0	115.0	0.0	85.0
Total cost: 975.0
took: 0.012 seconds
```

Результаты, полученные с помощью библиотеки `cvxopt`, совпадают с результатами, полученными вручную.
