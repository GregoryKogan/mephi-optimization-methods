# Задание №4

## Условие

**Вариант №8**

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        Сырьё & $A$ & $B$ & $C$ & $D$ & Запасы \\
    \hline
        Металл & $2$ & $1$ & $3$ & $1$ & $1200$ \\ \hline
        Пластмасса & $4$ & $1$ & $1$ & $5$ & $1500$ \\ \hline
        Резина & $8$ & $7$ & $9$ & $10$ & $2600$ \\ \hline
        \rowcolor[HTML]{E0FFFF}
        \textbf{Прибыль} & $7$ & $5$ & $3$ & $1$ & ~ \\ \hline
\end{tabular}
$$

## Постановка задачи

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        Сырьё & $A$ & $B$ & $C$ & $D$ & Запасы \\
    \hline
        Металл & $2$ & $1$ & $3$ & $1$ & $1200$ \\ \hline
        Пластмасса & $4$ & $1$ & $1$ & $5$ & $1500$ \\ \hline
        Резина & $8$ & $7$ & $9$ & $10$ & $2600$ \\ \hline
        \rowcolor[HTML]{E0FFFF}
        \textbf{Прибыль} & $7$ & $5$ & $3$ & $1$ & ~ \\ \hline
\end{tabular}
$$

### Прямая задача

Найти оптимальный план производства продукции с максимальной прибылью, для которого достаточно имеющихся ресурсов.  
$x_1$, $x_2$, $x_3$, $x_4$ – количество произведенной продукции  
Целевая функция:  
$F = 7x_1 + 5x_2 + 3x_3 + x_4 \rightarrow \max$  
Ограничения:

$$
\begin{cases}
    2x_1 + x_2 + 3x_3 + x_4 \leq 1200 \\
    4x_1 + x_2 + x_3 + 5x_4 \leq 1500 \\
    8x_1 + 7x_2 + 9x_3 + 10x_4 \leq 2600
\end{cases}
x_i \geq 0, \quad i \in \overline{1, 4}
$$

### Двойственная задача

Оценить каждый из видов сырья, используемого для производства продукции. Оценки, приписываемые каждому виду сырья, должны быть такими, чтобы оценка всего используемого сырья была минимальна, а суммарная оценка сырья, используемого для производства единицы продукции – не меньше цены единицы продукции.  
Целевая функция двойственной задачи:  
$F' = 1200y_1 + 1500y_2 + 2600y_3 \rightarrow \min$  
Ограничения:

$$
\begin{cases}
    2y_1 + 4y_2 + 8y_3 \geq 7 \\
    y_1 + y_2 + 7y_3 \geq 5 \\
    3y_1 + y_2 + 9y_3 \geq 3 \\
    y_1 + 5y_2 + 10y_3 \geq 1
\end{cases}
y_i \geq 0, \quad i \in \overline{1, 3}
$$

## Решение прямой задачи симплекс-методом

$$
\begin{cases}
    F = 7x_1 + 5x_2 + 3x_3 + x_4 \rightarrow \max \\
    2x_1 + x_2 + 3x_3 + x_4 \leq 1200 \\
    4x_1 + x_2 + x_3 + 5x_4 \leq 1500 \\
    8x_1 + 7x_2 + 9x_3 + 10x_4 \leq 2600 \\
    x_i \geq 0, \quad i \in \overline{1, 4}
\end{cases}
\quad
\Rightarrow
\quad
\begin{cases}
    F - 7x_1 - 5x_2 - 3x_3 - x_4 = 0 \\
    2x_1 + x_2 + 3x_3 + x_4 + x_5 = 1200 \\
    4x_1 + x_2 + x_3 + 5x_4 + x_6 = 1500 \\
    8x_1 + 7x_2 + 9x_3 + 10x_4 + x_7 = 2600 \\
    x_i \geq 0, \quad i \in \overline{1, 7}
\end{cases}
$$

$$
\begin{tabular}{|c|>{\columncolor[HTML]{98FB98}}c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ & $\frac{b_i}{\text{р.с.}} \geq 0$ \\
    \hline
        $x_5$ & $2$ & $1$ & $3$ & $1$ & $1$ & $0$ & $0$ & $1200$ & $600$ \\ \hline
        $x_6$ & $4$ & $1$ & $1$ & $5$ & $0$ & $1$ & $0$ & $1500$ & $375$ \\ \hline
        \rowcolor[HTML]{E0FFFF}
        $x_7$ & \cellcolor[HTML]{BDFDCC} $8$ & $7$ & $9$ & $10$ & $0$ & $0$ & $1$ & $2600$ & $325$ \\ \hline
        $F$ & $-7$ & $-5$ & $-3$ & $-1$ & $0$ & $0$ & $0$ & $0$ & ~ \\ \hline
\end{tabular}
$$

В последней строке есть элементы меньше нуля. Занулим элементы выше и ниже стоящие от разрешающего элемента.

$$
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ \\
    \hline
        $x_5$ & $0$ & $-\frac{3}{4}$ & $\frac{3}{4}$ & $-\frac{3}{2}$ & $0$ & $-\frac{1}{4}$ & $0$ & $550$ \\ \hline
        $x_6$ & $0$ & $-\frac{5}{2}$ & $-\frac{7}{2}$ & $0$ & $0$ & $1$ & $-\frac{1}{2}$ & $200$ \\ \hline
        $x_1$ & $1$ & $\frac{7}{8}$ & $\frac{9}{8}$ & $\frac{5}{4}$ & $0$ & $0$ & $\frac{1}{8}$ & $325$ \\ \hline
        $F$ & $0$ & $\frac{9}{8}$ & $\frac{39}{8}$ & $\frac{31}{4}$ & $0$ & $0$ & $\frac{7}{8}$ & $2275$ \\ \hline
\end{tabular}
$$

В последней строке все элементы больше нуля. Оптимальное решение найдено.  
Максимум функции $F$ достигается при $x_1 = 325$, $x_2 = 0$, $x_3 = 0$, $x_4 = 0$ и равен $F_{\max} = 2275$.

## Решение двойственной задачи через 3-ю теорему двойственности

Cоставим двойственную задачу:

$$
\begin{aligned}
&F' = 1200y_1 + 1500y_2 + 2600y_3 \rightarrow \min \\
&\begin{cases}
    2y_1 + 4y_2 + 8y_3 \geq 7 \\
    y_1 + y_2 + 7y_3 \geq 5 \\
    3y_1 + y_2 + 9y_3 \geq 3 \\
    y_1 + 5y_2 + 10y_3 \geq 1
\end{cases}
y_i \geq 0, \quad i \in \overline{1, 3}
\end{aligned}
$$

$y^{*} = \vec{c} \cdot A^{-1}_B$, где $\vec{c}$ - коэффициенты функции при базисных переменных, $A_B$ - матрица, составленная из векторов, вошедших в оптимальный базис.  
Последняя таблица из симплекс-метода:

$$
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ \\
    \hline
        $x_5$ & $0$ & $-\frac{3}{4}$ & $\frac{3}{4}$ & $-\frac{3}{2}$ & $0$ & $-\frac{1}{4}$ & $0$ & $550$ \\ \hline
        $x_6$ & $0$ & $-\frac{5}{2}$ & $-\frac{7}{2}$ & $0$ & $0$ & $1$ & $-\frac{1}{2}$ & $200$ \\ \hline
        $x_1$ & $1$ & $\frac{7}{8}$ & $\frac{9}{8}$ & $\frac{5}{4}$ & $0$ & $0$ & $\frac{1}{8}$ & $325$ \\ \hline
        $F$ & $0$ & $\frac{9}{8}$ & $\frac{39}{8}$ & $\frac{31}{4}$ & $0$ & $0$ & $\frac{7}{8}$ & $2275$ \\ \hline
\end{tabular}
$$

Базисные переменные: $x_1$, $x_5$, $x_6$.
Коэффициенты функции перед базисными переменными: $c_1 = 7$, $c_2 = 0$, $c_3 = 0$ $\Rightarrow \vec{c} = \begin{pmatrix} 7 & 0 & 0 \end{pmatrix}$  
Первая таблица из симплекс-метода:

$$
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ & $\frac{b_i}{\text{р.с.}} \geq 0$ \\
    \hline
        $x_5$ & $2$ & $1$ & $3$ & $1$ & $1$ & $0$ & $0$ & $1200$ & $600$ \\ \hline
        $x_6$ & $4$ & $1$ & $1$ & $5$ & $0$ & $1$ & $0$ & $1500$ & $375$ \\ \hline
        $x_7$ & $8$ & $7$ & $9$ & $10$ & $0$ & $0$ & $1$ & $2600$ & $325$ \\ \hline
        $F$ & $-7$ & $-5$ & $-3$ & $-1$ & $0$ & $0$ & $0$ & $0$ & ~ \\ \hline
\end{tabular}
$$

Берём из таблицы векторы, вошедшие в базис: $A_B = \begin{pmatrix} 2 & 1 & 0 \\ 4 & 0 & 1 \\ 8 & 0 & 0 \end{pmatrix}$.  
Вычислим $y^{*}$:

$y^{*} = 
\begin{pmatrix} 7 & 0 & 0 \end{pmatrix} \cdot \begin{pmatrix} 2 & 1 & 0 \\ 4 & 0 & 1 \\ 8 & 0 & 0 \end{pmatrix}^{-1} = 
\begin{pmatrix} 7 & 0 & 0 \end{pmatrix} \cdot \begin{pmatrix} 0 & 0 & \frac{1}{8} \\ 1 & 0 & -\frac{1}{4} \\ 0 & 1 & -\frac{1}{2} \end{pmatrix} =
\begin{pmatrix} 0 & 0 & \frac{7}{8} \end{pmatrix}$

Минимум функции достигается при $y_1 = 0$, $y_2 = 0$, $y_3 = \frac{7}{8}$.

$F'_{\min} = 0 \cdot 1200 + 0 \cdot 1500 + \frac{7}{8} \cdot 2600 = 2275$.

Значения целевых функций прямой и двойственной задачи совпали. $\Rightarrow$ Решение верно.

## Анализ результатов

1. Подставим $x^{*}$ в условия прямой задачи:  
   1-е и 2-е условия имеют знак $<$, значит, 1-й и 2-й ресурсы (металл и пластмасса) не являются дефицитными (остатки 550 и 200 соответственно).  
   3-е условие имеет знак $=$, значит, 3-й ресурс (резина) дефицитен.
2. Подставим $y^{*}$ в условия двойственной задачи:  
   1-е ограничение имеет знак $=$, следовательно, двойственная оценка ресурса, используемого для изготовления продукта в точности равна доходам, а значит продукт выгодно производить.  
   2-е, 3-е и 4-е ограничения имеют знак $>$, следовательно, производить изделия экономически невыгодно.
3. Величина двойственных оценок показывает, насколько возрастает целевая функция при увеличении запасов дефицитного ресурса на единицу.  
   Увеличение запасов 3-го ресурса (резина) на единицу приведет к новому оптимальному плану.
   Коэффициенты $A_B^{-1}$ показывают, что увеличение прибыли достигается за счет увеличения выпуска продукции $A$, при этом запасы металла сократятся на $\frac{1}{4}$ единицы, а пластмассы на $\frac{1}{2}$ единицы.

Ответ: $x^{*} = \begin{pmatrix} 325 & 0 & 0 & 0 \end{pmatrix}; \quad y^{*} = \begin{pmatrix} 0 & 0 & \frac{7}{8} \end{pmatrix}$

### Анализ устойчивости двойственных оценок

Определим интервалы устойчивости:  
$x^*_{b\text{нов}} = x_b + A_B^{-1} \cdot (b + \Delta b)$  
$A_B^{-1} \cdot (b + \Delta b) \geq 0$

$$
A_B^{-1} \cdot (b + \Delta b) =
\begin{pmatrix} 0 & 0 & \frac{1}{8} \\ 1 & 0 & -\frac{1}{4} \\ 0 & 1 & -\frac{1}{2} \end{pmatrix} \cdot \begin{pmatrix} 1200 + \Delta b_1 \\ 1500 + \Delta b_2 \\ 2600 + \Delta b_3 \end{pmatrix} =
\begin{pmatrix} 325 + \frac{1}{8}\Delta b_3 \\ 550 + \Delta b_1 - \frac{1}{4}\Delta b_3 \\ 200 + \Delta b_2 - \frac{1}{2}\Delta b_3\end{pmatrix} \geq 0
$$

Частные случаи:

1. $\Delta b_2 = \Delta b_3 = 0, \Delta b_1 \geq 0$

   $$
   \begin{pmatrix} 325 \\ 550 + \Delta b_1 \\ 200\end{pmatrix} \geq 0 \Leftrightarrow
    550 + \Delta b_1 \geq 0
    \Leftrightarrow \Delta b_1 \geq -550
   $$

   Запасы 1-го ресурса можно уменьшать не более чем на $550$ единиц, при этом оптимальный план двойственной задачи не изменится.

2. $\Delta b_1 = \Delta b_3 = 0, \Delta b_2 \geq 0$

   $$
   \begin{pmatrix} 325 \\ 550 \\ 200 + \Delta b_2\end{pmatrix} \geq 0 \Leftrightarrow
    200 + \Delta b_2 \geq 0
    \Leftrightarrow \Delta b_2 \geq -200
   $$

   Запасы 2-го ресурса можно уменьшать не более чем на $200$ единиц, при этом оптимальный план двойственной задачи не изменится.

3. $\Delta b_1 = \Delta b_2 = 0, \Delta b_3 \geq 0$

   $$
   \begin{pmatrix} 325 + \frac{1}{8}\Delta b_3 \\ 550 - \frac{1}{4}\Delta b_3 \\ 200 - \frac{1}{2}\Delta b_3\end{pmatrix} \geq 0 \Leftrightarrow
   \begin{cases}
        325 + \frac{1}{8}\Delta b_3 \geq 0 \\
        550 - \frac{1}{4}\Delta b_3 \geq 0 \\
        200 - \frac{1}{2}\Delta b_3 \geq 0
   \end{cases} \Leftrightarrow
    \begin{cases}
          \Delta b_3 \geq -2600 \\
          \Delta b_3 \leq 2200 \\
          \Delta b_3 \leq 400
    \end{cases} \Leftrightarrow
    -2600 \leq \Delta b_3 \leq 400
   $$

   Запасы 3-го ресурса можно уменьшать не более чем на $2600$ единиц и увеличивать не более чем на $400$ единиц, при этом оптимальный план двойственной задачи не изменится.

Предположим: $\Delta b_1 = -550$, $\Delta b_2 = 300$, $\Delta b_3 = -1337$.

$$
\begin{pmatrix} x_5^{\text{нов}} \\ x_6^{\text{нов}} \\ x_1^{\text{нов}} \end{pmatrix} =
\begin{pmatrix} 325 + \frac{1}{8} \cdot (-1337) \\ 550 - 550 - \frac{1}{4} \cdot (-1337) \\ 200 + 300 - \frac{1}{2} \cdot (-1337) \end{pmatrix} =
\begin{pmatrix} \frac{1263}{8} \\ \frac{1337}{4} \\ \frac{2337}{2} \end{pmatrix} \geq 0 \Rightarrow
$$

$\Rightarrow \Delta b_1, \Delta b_2, \Delta b_3$ сохраняют оценки ресурсов в пределах устойчивости, оптимальный план не изменится.  
Подставим новые значения в прямую задачу:  
$F_{\max}^{\text{нов}} = 7x_1^{\text{нов}} + 5x_2 + 3x_3 + x_4 = 7 \cdot \frac{2337}{2} + 5 \cdot 0 + 3 \cdot 0 + 0 = 8179.5$
