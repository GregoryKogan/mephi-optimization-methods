# Задание №4

Условие задачи:

$$
\begin{tabular}{|c|c|c|c|c|c|}
    \hline
        Сырьё & $A$ & $B$ & $C$ & $D$ & Запасы \\
    \hline
        Металл & $2$ & $1$ & $3$ & $1$ & $1200$ \\ \hline
        Пластмасса & $4$ & $1$ & $1$ & $5$ & $1500$ \\ \hline
        Резина & $8$ & $7$ & $9$ & $10$ & $2600$ \\ \hline
        \rowcolor[HTML]{E0FFFF}
        \textbf{Прибыль} & $7$ & $5$ & $3$ & $1$ & ~ \\ \hline
\end{tabular}
$$

Математическая модель задачи:

$$
\begin{aligned}
&F = 7x_1 + 5x_2 + 3x_3 + x_4 \rightarrow \max \\
&\begin{cases}
    2x_1 + x_2 + 3x_3 + x_4 \leq 1200 \\
    4x_1 + x_2 + x_3 + 5x_4 \leq 1500 \\
    8x_1 + 7x_2 + 9x_3 + 10x_4 \leq 2600
\end{cases}
x_i \geq 0, \quad i \in \overline{1, 4}
\end{aligned}
$$

## Решение прямой задачи симплекс-методом

$$
\begin{cases}
    F = 7x_1 + 5x_2 + 3x_3 + x_4 \rightarrow \max \\
    2x_1 + x_2 + 3x_3 + x_4 \leq 1200 \\
    4x_1 + x_2 + x_3 + 5x_4 \leq 1500 \\
    8x_1 + 7x_2 + 9x_3 + 10x_4 \leq 2600 \\
    x_i \geq 0, \quad i \in \overline{1, 4}
\end{cases}
\quad
\Rightarrow
\quad
\begin{cases}
    F - 7x_1 - 5x_2 - 3x_3 - x_4 = 0 \\
    2x_1 + x_2 + 3x_3 + x_4 + x_5 = 1200 \\
    4x_1 + x_2 + x_3 + 5x_4 + x_6 = 1500 \\
    8x_1 + 7x_2 + 9x_3 + 10x_4 + x_7 = 2600 \\
    x_i \geq 0, \quad i \in \overline{1, 7}
\end{cases}
$$

$$
\begin{tabular}{|c|>{\columncolor[HTML]{98FB98}}c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ & $\frac{b_i}{\text{р.с.}} \geq 0$ \\
    \hline
        $x_5$ & $2$ & $1$ & $3$ & $1$ & $1$ & $0$ & $0$ & $1200$ & $600$ \\ \hline
        $x_6$ & $4$ & $1$ & $1$ & $5$ & $0$ & $1$ & $0$ & $1500$ & $375$ \\ \hline
        \rowcolor[HTML]{E0FFFF}
        $x_7$ & \cellcolor[HTML]{BDFDCC} $8$ & $7$ & $9$ & $10$ & $0$ & $0$ & $1$ & $2600$ & $325$ \\ \hline
        $F$ & $-7$ & $-5$ & $-3$ & $-1$ & $0$ & $0$ & $0$ & $0$ & ~ \\ \hline
\end{tabular}
$$

В последней строке есть элементы меньше нуля. Занулим элементы выше и ниже стоящие от разрешающего элемента.

$$
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ \\
    \hline
        $x_5$ & $0$ & $-\frac{3}{4}$ & $\frac{3}{4}$ & $-\frac{3}{2}$ & $0$ & $-\frac{1}{4}$ & $0$ & $550$ \\ \hline
        $x_6$ & $0$ & $-\frac{5}{2}$ & $-\frac{7}{2}$ & $0$ & $0$ & $1$ & $-\frac{1}{2}$ & $200$ \\ \hline
        $x_1$ & $1$ & $\frac{7}{8}$ & $\frac{9}{8}$ & $\frac{5}{4}$ & $0$ & $0$ & $\frac{1}{8}$ & $325$ \\ \hline
        $F$ & $0$ & $\frac{9}{8}$ & $\frac{39}{8}$ & $\frac{31}{4}$ & $0$ & $0$ & $\frac{7}{8}$ & $2275$ \\ \hline
\end{tabular}
$$

В последней строке все элементы больше нуля. Оптимальное решение найдено.  
Максимум функции $F$ достигается при $x_1 = 325$, $x_2 = 0$, $x_3 = 0$, $x_4 = 0$ и равен $F_{\max} = 2275$.

## Решение двойственной задачи через 3-ю теорему двойственности

Cоставим двойственную задачу:

$$
\begin{aligned}
&F' = 1200y_1 + 1500y_2 + 2600y_3 \rightarrow \min \\
&\begin{cases}
    2y_1 + 4y_2 + 8y_3 \geq 7 \\
    y_1 + y_2 + 7y_3 \geq 5 \\
    3y_1 + y_2 + 9y_3 \geq 3 \\
    y_1 + 5y_2 + 10y_3 \geq 1
\end{cases}
y_i \geq 0, \quad i \in \overline{1, 3}
\end{aligned}
$$

$y^{*} = \vec{c} \cdot A^{-1}_B$, где $\vec{c}$ - коэффициенты функции при базисных переменных, $A_B$ - матрица, составленная из векторов, вошедших в оптимальный базис.  
Последняя таблица из симплекс-метода:

$$
\begin{tabular}{|c|c|c|c|c|c|c|c|c|}
    \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ \\
    \hline
        $x_5$ & $0$ & $-\frac{3}{4}$ & $\frac{3}{4}$ & $-\frac{3}{2}$ & $0$ & $-\frac{1}{4}$ & $0$ & $550$ \\ \hline
        $x_6$ & $0$ & $-\frac{5}{2}$ & $-\frac{7}{2}$ & $0$ & $0$ & $1$ & $-\frac{1}{2}$ & $200$ \\ \hline
        $x_1$ & $1$ & $\frac{7}{8}$ & $\frac{9}{8}$ & $\frac{5}{4}$ & $0$ & $0$ & $\frac{1}{8}$ & $325$ \\ \hline
        $F$ & $0$ & $\frac{9}{8}$ & $\frac{39}{8}$ & $\frac{31}{4}$ & $0$ & $0$ & $\frac{7}{8}$ & $2275$ \\ \hline
\end{tabular}
$$

Базисные переменные: $x_5$, $x_6$, $x_1$.
Коэффициенты функции перед базисными переменными: $c_1 = 0$, $c_2 = 0$, $c_3 = 7$.  
Вычислим $y^{*}$:

$y^{*} = \begin{pmatrix} 0 & 0 & 7 \end{pmatrix} \cdot \begin{pmatrix} 0 & -\frac{1}{4} & 0 \\ 0 & 1 & -\frac{1}{2} \\ 0 & 0 & \frac{1}{8} \end{pmatrix} = \begin{pmatrix} 0 & 0 & \frac{7}{8} \end{pmatrix}$

Минимум функции достигается при $y_1 = 0$, $y_2 = 0$, $y_3 = \frac{7}{8}$.

$F'_{\min} = 0 \cdot 1200 + 0 \cdot 1500 + \frac{7}{8} \cdot 2600 = 2275$.

Значения целевых функций прямой и двойственной задачи совпали. $\Rightarrow$ Решение верно.
